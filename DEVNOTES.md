# Developer Notes

Этот документ дополняет README и описывает ключевые классы,
значимые переменные и рекомендации по запуску.

## Основные классы

- **Chulan** (`main.py`)
  - Хранит параметры обработки: имя файла вебхука, пути до директорий,
    объект API и флаги логирования.
- **Queue** (`classes/my_queue.py`)
  - Загружает события из аудита вебхука. Для каждого события создаёт
    директорию, сохраняет JSON и запускает `Checker` и `Judge`.
- **Checker** (`classes/checker.py`)
  - Получает счёт и формирует структуру `big_data` со всеми параметрами
    счета: сумма, скидки, текущие галочки и статус.
- **Judge** (`classes/judge.py`)
  - На основе `big_data` принимает решение о смене статуса документа и
    о сбросе галочек через API.
- **APIClient** (`classes/mymslib.py`)
  - Обёртка над HTTP API «Мой склад». Содержит методы `get`, `post`,
    `put`, а также вспомогательные функции.
- **Dir_master** (`classes/dir_master.py`)
  - Утилиты для создания директорий и перемещения файлов.

Дополнительные файлы вроде `super_event_worker.py` и `tovaroved.py`
являются черновыми вариантами и в основной процесс не включаются.

## Запуск

1. Установите зависимости из `requirements.txt`:

   ```bash
   pip install -r requirements.txt
   ```
2. При получении вебхуков запускается `trap.php`. Он сохраняет JSON в
   `echo/webhooks/` и запускает `main.py` с именем файла:

   ```bash
   php echo/trap.php
   # или напрямую
   python3 echo/main.py <имя_файла>
   ```

Всю информацию о ходе работы ищите в каталоге `logus/`.
